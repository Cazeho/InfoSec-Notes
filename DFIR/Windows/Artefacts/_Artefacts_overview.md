# DFIR - Windows artefacts overview

A more detailed explanation of the artefacts, and associated parsing tools, are
/ will be available in dedicated sub-notes.

### General

| Name | Type | Description | Information / interpretation | Location |
|------|------|-------------|----------------|----------|
| `EVTX` | General | Overall system usage: Accounts authentication successes and failures, local accounts and groups management, Windows Services or scheduled tasks operations, PowerShell activity, etc. | - | `%SystemRoot%\System32\winevt\Logs\*` |

### System information

| Name | Type | Description | Information / interpretation | Location |
|------|------|-------------|----------------|----------|
| `ComputerName` registry key | System information | Name of the computer. | - | File: `%SystemRoot%\System32\config\SYSTEM` <br> Registry key: `HKLM\SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName` |
| `FirewallPolicy` registry keys | System information | Windows local Firewall profiles (Public, Private, and Domain) status and configured rules. | - | File: `%SystemRoot%\System32\config\SYSTEM` <br> Registry key: `HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\*` |
| Network interfaces (`Interfaces` registry keys) | System information | Basic information about network interfaces (interface name, associated IP address, default gateway, and DHCP lease and eventual domain) | - | File: `%SystemRoot%\System32\config\SYSTEM` <br> Registry keys: `HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\*` |
| Security `Policy` registry keys | System information | Basic information on the system: <br> - Computer name and `SID`. <br> - Computer's domain and domain `SID` (for domain-joined hosts). | - | File: `%SystemRoot%\System32\config\SECURITY` <br><br> Registry keys under `HKLM\SECURITY\Policy`: <br> - `PolAcDmN`: computer name <br> - `PolAcDmS`: computer `SID` <br> - `PolDnDDN`: computer's domain name <br> - `PolPrDmS`: computer's domain `SID` |
| `TimeZoneInformation` Registry key | System information | Time zone information. | - | File: `%SystemRoot%\System32\config\SYSTEM` <br> Registry key: `HKLM\System\ControlSet001\Control\TimeZoneInformation` |
| `Select` registry key | System information | `ControlSet` information for the `ControlSet001`, `ControlSet002`, etc. registry keys: <br> - Current `ControlSet` pointed by the `CurrentControlSet` key. <br> - Last known good `ControlSet`. | - | File: `%SystemRoot%\System32\config\SYSTEM` <br> Registry key: `HKLM\SYSTEM\Select` |

### Program execution

| Name | Type | Description | Information / interpretation | Location |
|------|------|-------------|----------------|----------|
| Windows 10 Timeline / `ActivitiesCache.db` <br><br> Introduced in Windows 10's version 1803.	| Programs execution | XXX <br><br> For more information: [ActivitiesCache.db note](./ActivitiesCache_db.md). | XXX | `C:\Users\<USERNAME>\AppData\Local\ConnectedDevicesPlatform\L.<USERNAME>\ActivitiesCache.db` |
| `Amcache` <br><br> Starting from Windows 7 & Windows Server 2008 R2 | Programs execution | XXX <br><br> For more information: [Amcache note](./Amcache.md). | XXX | `%SystemRoot%\AppCompat\Programs\Amcache.hve` |
| `Jumplist` | Programs execution | Detailed in `Files and folders access` | - | - |
| `Prefetch` <br><br> Not present by default on Windows Server Operating Systems. | Programs execution | Linked to a performance enhancement feature that enables prefetching of applications to make system boots or applications startups faster. <br><br> For more information: [Prefetch note](./Prefetch.md). | Each Prefecth file can yield the following information: <br><br> - The file name and size of the binary executed. <br><br> - The first and last eight executions timestamps <br><br> - The run count (number of time the binary was executed). <br><br> - The list of files and directories accessed during the first ten seconds of execution (including the eventual `DLL` loaded or PowerShell scripts for PowerShell execution). | `Prefetch` files (`.PF`) in: <br> `%SystemRoot%\Prefetch\*` |
| `Application Compatibility Cache` <br> / <br> `Shimcache` | Programs execution | Application compatibility feature that aim to maintain support of existing software to new versions of the Windows operating system. <br><br> `Shimcache` entries are only written to the registry upon shutdown of the system. The `Shimcache` entries generated since the last system boot are thus only stored in memory. <br><br> For more information: [Shimcache note](./Shimcache.md). | Each `Shimcache` entries contain the notable information: <br><br> - The associated file full path. <br><br> - The `LastModifiedTime` (`$Standard_Information`) timestamp of the file, which does not necessarily reflect the execution time. <br><br> - On Windows 2003 / XP 64-bit and older, the file size. <br><br> - On Windows Vista / Windows Server 2008, the (undocumented) `Process Execution Flag` flag which seems to indicate whether the entry was executed. <br><br> - On `Windows XP 32-bit`, the file `Last Update Time` timestamp.| File: `%SystemRoot%\System32\config\SYSTEM` <br> Registry key: `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\AppCompatCache` |
| `System Resource Usage Monitor (SRUM)` <br><br> Introduced in Windows 8. | Programs execution | Feature that records numerous metrics of system activities, with a limited subset displayed within the Windows `Task Manager` ("App history" tab). <br><br> For more information: [SRUM note](./SRUM.md). | The Resources usage (table `{D10CA2FE-6FCF-4F6D-848E-B2E99266FA89}`) can help track programs execution. For each execution entry, the following information may be recorded: <br><br> - The timestamp of execution. <br><br> - Full path of the executable or application information / description for built-in components. <br><br> - User `SID` of the user executing the process. <br><br> - Metrics on CPU usage (CPU time in foreground and background). <br><br> - Metrics on I/O operations (foreground / background number of read / write operations and bytes read / written). | `%SystemRoot%\System32\SRU\SRUDB.dat` |
| `UserAssist` | Programs execution | Executions of programs with a graphical interface, installed or from a portable executable. The purpose of the `UserAssist` registry key is not official documented. | One or two main registry subkeys can be found depending on the Windows OS version: <br><br> - On Windows Xp, `{75048700-EF1F-11D0-9888-006097DEACF9}` linked to execution of executable files <br><br> - Starting from Windows 7, `{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}` linked to execution of executable files and `{F4E57C4B-2036-45F0-A9AB-443BCFE33D9F}` linked to execution of shortcut files. <br><br> Keys are `ROT13` encoded, and contains the following notable information: <br><br> - Full path of the executed program / shortcut. <br><br> - Sometimes, the timestamp of the last execution. <br><br> - An unreliable run counter. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br> Registry key:  `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\<GUID>\Count` |
| Common Dialogs - <br> `CIDSizeMRU` | Programs execution | Recently executed programs, linked to `Common Dialogs` activities (pop boxes to open / save file, print, find / replace, ...). | The key contains an ordered `Most Recently Used (MRU)` list of executed programs, identified through their filename. <br><br> The last write timestamp of the key thus corresponds to the timestamp of execution of the most recently executed program (first in the MRU list). | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br> Registry key:  `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\CIDSizeMRU` |
| Common Dialogs - <br><br> `LastVisitedMRU ` <br><br> `LastVisitedPidlMRU` <br> `LastVisitedPidlMRULegacy` <br> Renamed in Windows Vista and later. | Programs execution | Records the programs used to open / save (some of) the file tracked in the `OpenSaveMRU` / `OpenSavePidlMRU` registry key. <br><br> Notably used to track the last folder used by a given program in an "Open File" / "Save File" `Common Dialogs` window. | Applications tracked are stored in an ordered `Most Recently Used (MRU)` list. The last write timestamp of the key thus corresponds to the timestamp of execution of the most recently executed program (first in the MRU list). <br><br> For each application, the full path of the folder can be constructed from information blocks on each subfolder in the location. For exemple, for the "C:\Users\Public\Documents" location, three blocks will be present: "Users", "Public", and "Documents". For each block, the created and last accessed timestamps and the MFT entry / sequence associated with the folder are referenced. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br><br> Registry key: <br> `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedMRU` <br> `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedPidlMRU` <br> `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedPidlMRULegacy` |

### Filesystem

| Name | Type | Description | Information / interpretation | Location |
|------|------|-------------|----------------|----------|
| `MFT` | Filesystem | Main element of any `NTFS` partition with the MFT, filename `$MFT`, being the first file of the partition. <br><br> The MFT contains an entry for all existing files written on the partition. Deleted files that were once written on the partition may also still have a record in the MFT. <br><br> For more information: [MFT note](./MFT.md). | Each record entry in the MFT notably includes: <br><br> - The filename. <br><br> - The file size. <br><br> - The file creation, last modified, last accessed, last changed `SI` timestamps (`MACB`) in the `$STANDARD_INFORMATION` attribute. <br><br> - The file creation, last modified, last accessed, last XXX `FN` timestamps (`MACB`) in the `$FILE_NAME` attribute. <br><br> - File access permissions. <br><br> - ... <br><br> For more information on Windows timestamps: <br> [Windows timestamps note](./Timestamps.md). | `%SystemDrive%:\$MFT` |
| `UsnJrnl` | Filesystem | Feature of `NTFS`, activated by default on Vista and later, which maintains a record of changes made to the `NTFS` volume. The creation, deletion or modification of files or directories are; among other operations, journalized. <br><br> The records in the `UsnJrnl` are progressively overwritten once the max size of the journal has been reached. The `UsnJrnl` usually contains historical data on the last few days (1-3 days for system full time use, < 7 days for regular system use). | The `UsnJrnl` is composed of two data streams: <br><br> - The `$Max` data stream stores the meta data of the change. <br><br> - The `$J` data stream stores the actual change log records. <br><br> Each change log record is notably composed of: <br><br> - an `Update Sequence Number (USN)`. <br><br> - The timestamp of the change. - The reason / operation of the record (`USN_REASON_FILE_CREATE`,   `USN_REASON_FILE_DELETE`, `USN_REASON_DATA_OVERWRITE`,     `USN_REASON_RENAME_NEW_NAME`, etc.). <br><br> - MFT reference and reference sequence number. | `$Max` and `$J` files under `\$Extend\$UsnJrnl` |
| `Recycle Bin` | Filesystem (Deleted files) | Deleted files and folders (if deleted through a recycle bin aware application). | Two kind of files are present in the Recycle Bin: <br><br> - `$I` (for "Information") files, which contain the path and timestamp of deletion of the original file. <br><br> - `$R` (for "Resource") files, which contain the original file content. | `%SystemDrive%:\$Recycle.Bin\<USER_SID>\*` |

### Files and folders access

| Name | Type | Description | Information / interpretation | Location |
|------|------|-------------|----------------|----------|
| Windows 10 Timeline / `ActivitiesCache.db` <br><br> Introduced in Windows 10's version 1803. | Files and folders access | Detailed in `Program execution` | - | - |
| `Jumplist` | Files and folders access | Linked to a taskbar user experience-enhancing feature that allows users to "jump" to files, folders or others elements by right clicking on open applications in the `Windows taskbar`. The `Windows Explorer`'s `Quick Access` feature also stores entries in `Jumplists`. <br><br> Two forms of `Jumplists` are created: <br> - automatic entries for recently accessed items: `*.automaticDestinations-ms` files. <br> - custom entries in `*.customDestinations-ms` files for items manually "pinned" elements: `*.customDestinations-ms` <br><br> For more information: [Jumplist note](./Jumplist.md). | Each application `AutomaticDestinations` and `CustomDestinations` JumpLists are assimilable to a series of `shortcut files (LNK)`. <br><br> Each entry (shortcut) in an application `AutomaticDestinations` or `CustomDestinations` JumpList thus contains the same level of information found in a `shortcut file`. | `%SystemDrive%:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations\*.automaticDestinations-ms` <br><br> `%SystemDrive%:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Recent\CustomDestinations\*.customDestinations-ms` |
| `LNK (shortcuts) Files` | Files and folders access | Windows Shell Items that reference an original file, folder, or application. <br><br> While `shortcut files` can be created manually, the Windows operating system also creates `shortcut files` under numerous user activities, such as opening of a non-executable file. For instance, a `shortcut file` is created under `[...]\AppData\Roaming\Microsoft\Windows\Recent\` whenever a file is opened from the `Windows Explorer`. <br><br> For more information: [LNKFile note](./LNKFile.md). | The creation and modification timestamps of the shortcut file itself will usually respectively indicate when the target file was first and last opened. <br><br> Each shortcut file additionly yield the following information: <br><br> - The target file's absolute path, size and attributes (hidden, read-only, etc.). <br><br> - The target file modified, access, and created (MAC) timestamps at the time of the last access to the target file. <br><br> - Whether the target file was stored locally or on a remote network share. <br><br> - Occasionally information on the volume of the target file: name, type (fixed vs removable storage media), serial number, and label / name if any. <br><br> - Occasionally information on the host of the target file: system's NetBIOS hostname and MAC address. | Automatically created `shortcut files`  for files opened from the Windows Explorer: <br> `%SystemDrive%:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Recent\*.lnk` <br><br> Documents opened using `Microsoft Office`: <br> `%SystemDrive%:\Users\<USERNAME>\AppData\Roaming\Microsoft\Office\Recent\*.lnk` <br><br> `Shortcut files` created automatically by the `Windows Explorer` are referenced in the `NTUSER.DAT\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs` registry keys. <br><br> `Startup folders` items: <br> `%SystemDrive%:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp` <br> `%SystemDrive%:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup` <br><br>  |
| `Map Network Drive MRU` | Files and folders access | Recently used network shares. | - | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br><br> Registry key: <br> `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Map Network Drive MRU` |
| `Shellbag` | Files and folders access | Registry keys designed as an user experience enhancing feature to keep track of Windows explorer graphical display settings on a folder-by-folder basis. For instance, a Shellbag entry is used to store the "View" mode of a folder (details, list, small / medium / large icons) as well as the column displayed (entry names, dates, sizes, etc.) and their order. <br><br> For more information: [Shellbags note](./Shellbags.md). | Various kinds of user activity may generate or update Shellbag entries (with different level of data depending on the activity): <br><br> - First access or renaming of folders, removable devices, or network shares through the Windows Explorer systematically generate a Shellbag entry <br><br> - Graphical opening of compressed archives or ISOs <br><br>   - ... <br><br> Each Shellbags entry for a given target yield the following notable information: <br><br> - The target name and absolute path. <br><br> - The target modified, access, and created (MAC) timestamps (UTC), retrieved from the `$MFT` at the Shellbag entry creation (and not further updated). <br><br> Additionally each entry in ShellBags `BagMRU` maintain a `MRUListEx` list, which records the order in which the sub targets of a target were accessed (the last sub target accessed having a `MRU position` of 0). This can be used to deduce the first and last interacted timestamps for some targets. | Starting from Windows 7: <br><br> Files: <br> `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br> `%SystemDrive%:\Users\<USERNAME>\AppData\Local\Microsoft\Windows\UsrClass.dat` <br><br> Registry keys: <br> `NTUSER.DAT\Software\Microsoft\Windows\Shell\BagMRU` <br> `NTUSER.DAT\Software\Microsoft\Windows\Shell\Bags` <br> `UsrClass.dat\Local Settings\Software\Microsoft\Windows\Shell\BagMRU` <br> `UsrClass.dat\Local Settings\Software\Microsoft\Windows\Shell\Bags` |
| `WordWheelQuery` <br><br> Starting from Windows 7 and not present on Windows Server Operating Systems. | Files and folders access | Keywords searched in from the Windows start menu, potentially resuling in files or folders access or program execution. | The entries are stored in a `Most Recently Used (MRU)` list. The last write timestamp of the key indicates the timestamp of the most recently searched keyword. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br> Registry key:  `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\WordWheelQuery` |
| Common Dialogs - <br><br> `OpenSaveMRU` <br><br> `OpenSavePidlMRU` <br> Renamed in Windows Vista and later. | Files and folders access | Information on files opened or saved through the "Open File" or "Save File" `Common Dialogs` window. | The `OpenSaveMRU`/ `OpenSavePidlMRU` keys has multiple subkeys, one for each different file extensions (for the files opened / saved on the given system). <br><br> Each subkey contains an ordered `Most recently used (MRU)` list of opened / saved files (fullpath of the file). The list can go up to 20 entries, with entries over 20 being overwritten. <br><br> The last write timestamp of each subkey thus corresponds to the timestamp of opening / saving of the file in MRU position 0 (for a given file extension). | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br><br> Registry key: <br> `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSaveMRU` <br> `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSavePidlMRU` |

### Remote Access / Lateral movements

| Name | Type | Description | Information / interpretation | Location |
|------|------|-------------|----------------|----------|
| `PortProxy` registry key | Remote Access / Lateral movements | `netsh` port forwarding activity: listening host / port and remote host / port. | - | File: `%SystemRoot%\System32\config\SYSTEM` <br> Registry key: `HKLM\SYSTEM\ControlSet001\Services\PortProxy\v4tov4\tcp\*` |
| `SSHlogs` | Remote Access / Lateral movements | `OpenSSH` for Windows logs in a text format. Not enabled by default (requires `SyslogFacility LOCAL0` / `LogLevel Debug3`) to be set in the server `sshd_config`. | Contains information about users successful and unsuccessful authentication attempts (with the associated IP source). | `%ProgramData%\ssh\logs` |
| `ProfileList` registry keys | Remote Access / Lateral movements | `SID` to username correspondence for accounts that have logged on the system (including for domain accounts). | The last write timestamp of each key indicates was the associated user last logged on the system. | File: `%SystemRoot%\System32\config\SOFTWARE` <br> Registry key: `HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList` |
| `Terminal Server Client\Servers` registry keys | Remote Access / Lateral movements | IP address of the remote host(s) the user connected to (from the local system), stored as one key per remote host. | For each key: <br><br> - The `UsernameHint` value contains the eventual saved username for the connection. <br><br> - The last written timestamp may be an indicator of the first access to the remote host (but can also be updated for various other reasons). | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br> Registry key: `HKCU\SOFTWARE\Microsoft\Terminal Server Client\Servers\<IP>` |
| `RDP Bitmap Cache` | Remote Access / Lateral movements | Partial captures of the remote desktop screen from the Remote Desktop Client for RDP sessions. <br><br> Implemented to reduce the amout of data sent by the server to save bandwidth usage. <br><br> Bitmap caching be deactivated client-side in the Remote Desktop Client. | - | Windows XP / Windows Server 2003: <br> `%SystemDrive%:\Documents and Settings\<USERNAME>\Local Settings\Application Data\Microsoft\Terminal Server Client\Cache\*` <br><br> Windows 7 and later: `%SystemDrive%:\Users\<USERNAME>\AppData\Local\Microsoft\Terminal Server Client\Cache\*` |
| `User Access Logging (UAL)` <br><br> Windows Server only, introduced in Windows Server 2012. | Remote Access / Lateral movements | Feature that consolidates data on client activity. <br><br> On Domain Controllers, yield information on sessions opening on domain-joined computers (if the given DC was reached for authentication / `Group Policy` retrieval). <br><br> For more information: [User Access Logging note](./User_Access_Logging.md). | The information is stored locally in up to five `Extensible Storage Engine (ESE)` database files (`.mdb`), including: <br><br> - The `Current.mdb` file which contains data for the last 24-hour. <br><br> - Up to three `<GUID>.mdb` files, which contain data for an entire year (first to last day), going back to 2 years. <br><br> The `CLIENTS` table of the aforementioned databases contain notable information: <br><br> - Accessed Windows Server role `GUID` and description (`AD DS`, `AD CS`, `SMB / CIFS` service notably) <br><br> - The client domain and username. <br><br> - Total number of access. <br><br> - First, last, and daily access timestamps. <br><br> - Client `IPv4` or `IPv6` address. <br><br> On Domain Controllers, the hostname associated with a given `IP` address at that time may be retrievable as machine accounts of domain-joined computers also authenticate to `AD DS`. | Database files (`.mdb`) in `%SystemRoot%\System32\Logfiles\SUM\` |

### ASEPs / Persistence

### Web browsing

### Network usage

| Name | Type | Description | Information / interpretation | Location |
|------|------|-------------|----------------|----------|
| `NetworkList` registry keys | Network usage | Basic network historical information (network name and type, first and last connection, etc.) | - | File: `%SystemRoot%\System32\config\SYSTEM` <br> Registry key: `HKLM\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles\` |
| `System Resource Usage Monitor (SRUM)` <br><br> Introduced in Windows 8. | Network usage | Detailed in `Program execution`. | The Network data usage table (table `{973F5D5C-1D90-4944-BE8E-24B94231A174}`) can help track programs execution and network usage of the executed programs. <br><br> For each execution entry, the following information may be recorded: <br><br> - Timestamp of execution. <br><br> - Full path of the executable or application information / description for built-in components. <br><br> - Metrics on network data usage (bytes sent and receive on a given network interface). | - |



### Third-party applications

| Name | Type | Description | Information / interpretation | Location |
|------|------|-------------|----------------|----------|
| `Azure`'s PowerShell / CLI activity | Interaction with Azure though the `Az` PowerShell module and `az` CLI utility. |  Folder `telemetry`: may contain information on `azurecli` commands (user Azure ID, raw command, etc.). <br><br> Folder `commands`: similar to `telemetry` folder, with less data on the executed `azure cli` commands. <br><br> Folder `ErrorRecords`: details on HTTP requests, and their associated response, that generated an error. | `C:\Users\<USERNAME>\.azure\*` |

### TODO

| Name | Information relative to | Location | Description |
|------|-------------------------|----------|-------------|
| Common Dialogs - <br> `FirstFolder` | Programs execution <br><br> Files and folders access. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br><br> Registry key: <br> `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\FirstFolder` |
| `FeatureUsage` | Programs execution <br><br> Introduced in Windows 10's version 1903. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br><br> Registry keys under ` HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FeatureUsage`. | Registry keys: <br><br> - `AppSwitched`: number of times an application was brought to focus (application left-clicked on the taskbar). <br> - `ShowJumpView`: number of times the jump menu of an application was opened (application right-clicked on the taskbar). <br> - `AppBadgeUpdated`: number of times an application on the taskbar has have its icon updated (for example for notifications). <br> - `AppLaunch`: number of times an application pinned on the taskbar has been executed. <br> - `TrayButtonClicked`: numer of times a default taskbar button (such as the Windows start button) was clicked. |
| `RecentApps` | Programs execution <br><br> Files and folders access. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br> Registry key:  `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search\RecentApps\<GUID>` |
| `RecentDocs` | Non-executable files opened through the Windows Explorer, stored as one subkey per file extension. <br><br> Each subkey contains the opened files of the given extension stored in a Most Recently Used (MRU) list. The last written timestamp of the key correspond to the timestamp of the opening of the most recently accessed file (MRU position 0).  <br><br> Entry created under the RecentDocs registry keys are associated with a shortcut file under `%SystemDrive%:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Recent\`. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat`  <br> Registry key:  `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs` |
| `RecentFileCache` <br><br> Replaced by `Amcache.hve` on  Windows 7 (patched) and later operating systems. | Programs execution | `%SystemRoot%\AppCompat\Programs\RecentFileCache.bcf` |
| `RunMRU` | Programs execution | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat`  <br> Registry key:  `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RunMRU` |
| `TypedPaths` | Files and folders access. <br><br> Potential Programs execution | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat`  <br> Registry key:  `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths` |
| `TypedURLs` | Files and folders access. <br><br> Potential Programs execution | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat`  <br> Registry key:  `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\TypedURLs` |
| `Windows Background Activity Moderator (BAM)` <br><br> Introduced in Windows 10's Fall Creators update - version 1709. | Programs execution | File: `%SystemRoot%\System32\config\SYSTEM` <br><br> Registry key: <br> `HKLM\SYSTEM\CurrentControlSet\Services\bam\UserSettings\<SID>\*` <br> After from Win10 1809: `HKLM\SYSTEM\CurrentControlSet\Services\bam\State\UserSettings\<SID>\*` |
| Windows Search | Files and folders access. | `%SystemDrive%:\ProgramData\Microsoft\Search\Data\Applications\Windows\Windows.edb` |

--------------------------------------------------------------------------------

### References

https://blog.1234n6.com/2018/10/available-artifacts-evidence-of.html

SANS posters Windows forensics - https://www.sans.org/posters/windows-forensic-analysis/

https://www.scitepress.org/papers/2017/64167/64167.pdf

http://windowsir.blogspot.com/2013/07/howto-determine-program-execution.html

https://www.sans.org/blog/opensavemru-and-lastvisitedmru/
