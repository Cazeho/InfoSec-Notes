# DFIR - Windows artefacts overview

A more detailed explanation of the artefacts, and associated parsing tools, are
/ will be available in dedicated sub-notes.

| Name | Information relative to | Location | Description |
|------|-------------------------|----------|-------------|
| `ActivitiesCache.db` <br><br> Introduced in Windows 10's version 1803.	| Programs execution. <br><br> Files and folders access. | `C:\Users\<USERNAME>\AppData\Local\ConnectedDevicesPlatform\L.<USERNAME>\ActivitiesCache.db` |
| `Amcache` | Programs execution. | `%SystemRoot%\AppCompat\Programs\Amcache.hve` |
| Common Dialogs - <br> `CIDSizeMRU` | Programs execution. <br><br> Recently executed applications, linked to Common Dialogs activities stored as a Most Recently Used (MRU) list. <br><br> The last write timestamp of the key correspond to the timestamp of execution of the last program (first in the MRU list). | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br> Registry key:  `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\CIDSizeMRU` |
| Common Dialogs - <br> `FirstFolder` | Programs execution. <br><br> Files and folders access. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br><br> Registry key: <br> `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\FirstFolder` |
| Common Dialogs - <br> `OpenSaveMRU` <br> `OpenSavePidlMRU` <br><br> Renamed in Windows Vista and later. | Files (absolute path) opened or saved within a Windows Common Dialogs window. <br><br> Most recently used (MRU) list is tracked by file extension, with the opening / saving timestamp of the most recent event (MRU position 0) for a given file extension. <br><br> `[OpenSaveMRU\|OpenSavePidlMRU]\*`: last 20 files to have been opened / saved. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br><br> Registry key: <br> `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSaveMRU` <br> `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSavePidlMRU` |
| Common Dialogs - <br> `LastVisitedMRU ` <br> `LastVisitedPidlMRU` <br> `LastVisitedPidlMRULegacy` <br><br> Renamed in Windows Vista and later. | Programs execution. <br><br> Files and folders access. <br><br> Record the executables used to open (some of) the file tracked in `OpenSaveMRU` / `OpenSavePidlMRU`. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br><br> Registry key: <br> `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedMRU` <br> `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedPidlMRU` <br> `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedPidlMRULegacy` |
| `ComputerName` registry key | Name of the computer. | File: `%SystemRoot%\System32\config\SYSTEM` <br> Registry key: `HKLM\SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName` |
| `EVTX` | Overall system usage: Accounts authentication successes and failures, local accounts and groups management, Windows Services or scheduled tasks operations, PowerShell activity, etc. | `%SystemRoot%\System32\winevt\Logs\*` |
| `FeatureUsage` | Programs execution. <br><br> Introduced in Windows 10's version 1903. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br><br> Registry keys under ` HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FeatureUsage`. | Registry keys: <br><br> - `AppSwitched`: number of times an application was brought to focus (application left-clicked on the taskbar). <br> - `ShowJumpView`: number of times the jump menu of an application was opened (application right-clicked on the taskbar). <br> - `AppBadgeUpdated`: number of times an application on the taskbar has have its icon updated (for example for notifications). <br> - `AppLaunch`: number of times an application pinned on the taskbar has been executed. <br> - `TrayButtonClicked`: numer of times a default taskbar button (such as the Windows start button) was clicked. |
| `FirewallPolicy` registry keys | Windows local Firewall profiles (Public, Private, and Domain) status and configured rules. | File: `%SystemRoot%\System32\config\SYSTEM` <br> Registry key: `HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\*` |
| `Jumplist` | Files and folders access. | `%SystemDrive%:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations\*.automaticDestinations-ms` <br><br> `%SystemDrive%:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Recent\CustomDestinations\*.customDestinations-ms` |
| `LNK (shortcuts) Files` | Files and folders access. | `%SystemDrive%:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Recent\*.lnk` <br><br> `%SystemDrive%:\Users\<USERNAME>\AppData\Roaming\Microsoft\Office\Recent\*.lnk` | While `shortcut files` can be created manually, the Windows operating system also creates `shortcut files` under numerous user activities, such as opening of a non-executable file. <br><br> For instance, a `shortcut file` is created under `[...]\AppData\Roaming\Microsoft\Windows\Recent\` whenever a file is opened from the `Windows Explorer`. <br> `Shortcut files` created in such circumstances are referenced in the `NTUSER.DAT\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs` registry keys. |
| `Map Network Drive MRU` | Recently used network shares. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br><br> Registry key: <br> `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Map Network Drive MRU` |
| `MFT` | Filesystem and limited filesystem history. | `%SystemDrive%:\$MFT` |
| `NetworkList` registry keys | Basic network historical information (network name and type, first and last connection, etc.) | File: `%SystemRoot%\System32\config\SYSTEM` <br> Registry key: `HKLM\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles\` |
| Network interfaces (`Interfaces` registry keys) | Basic information about network interfaces (interface name, associated IP address, default gateway, and DHCP lease and eventual domain) | File: `%SystemRoot%\System32\config\SYSTEM` <br> Registry keys: `HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\*` |
| `PortProxy` registry key | `netsh` port forwarding activity: listening host / port and remote host / port. | File: `%SystemRoot%\System32\config\SYSTEM` <br> Registry key: `HKLM\SYSTEM\ControlSet001\Services\PortProxy\v4tov4\tcp\*` |
| `Prefetch` | Programs execution. | `%SystemRoot%\Prefetch\*` |
| `ProfileList` registry keys |  `SID` to username correspondence for accounts that have logged on the system (including for domain accounts). | File: `%SystemRoot%\System32\config\SOFTWARE` <br> Registry key: `HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList` |
| `RDP Bitmap Cache` | Partial captures of the remote desktop screen for RDP sessions. | Windows XP / Windows Server 2003: <br> `%SystemDrive%:\Documents and Settings\<USERNAME>\Local Settings\Application Data\Microsoft\Terminal Server Client\Cache\*` <br><br> Windows 7 and later: `%SystemDrive%:\Users\<USERNAME>\AppData\Local\Microsoft\Terminal Server Client\Cache\*` |
| `RecentApps` | Programs execution. <br><br> Files and folders access. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br> Registry key:  `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search\RecentApps\<GUID>` |
| `RecentDocs` | Non-executable files opened through the Windows Explorer, stored as one subkey per file extension. <br><br> Each subkey contains the opened files of the given extension stored in a Most Recently Used (MRU) list. The last written timestamp of the key correspond to the timestamp of the opening of the most recently accessed file (MRU position 0).  <br><br> Entry created under the RecentDocs registry keys are associated with a shortcut file under `%SystemDrive%:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Recent\`. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat`  <br> Registry key:  `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs` |
| `RecentFileCache` <br><br> Replaced by `Amcache.hve` on  Windows 7 (patched) and later operating systems. | Programs execution. | `%SystemRoot%\AppCompat\Programs\RecentFileCache.bcf` |
| `Recycle Bin` | Deleted files | `%SystemDrive%:\$Recycle.Bin\<SID>\*` <br><br> `$I` (for "Information") files, which contain the path and timestamp of deletion of the original file. <br> `$R` (for "Resource") files, which contain the original file content. |
| `RunMRU` | Programs execution. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat`  <br> Registry key:  `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RunMRU` |
| Security `Policy` registry keys | Basic information on the system: <br> - computer name and `SID`. <br> - computer's domain and domain `SID` (for domain-joined hosts). | File: `%SystemRoot%\System32\config\SECURITY` <br><br> Registry keys under `HKLM\SECURITY\Policy`: <br> - `PolAcDmN`: computer name <br> - `PolAcDmS`: computer `SID` <br> - `PolDnDDN`: computer's domain name <br> - `PolPrDmS`: computer's domain `SID` |
| `Select` registry key | `ControlSet` information for the `ControlSet001`, `ControlSet002`, etc. registry keys: <br> - Current `ControlSet` pointed by the `CurrentControlSet` key. <br> - Last known good `ControlSet`. | File: `%SystemRoot%\System32\config\SYSTEM` <br> Registry key: `HKLM\SYSTEM\Select` |
| `Shellbag` | Files and folders access. | Starting for Windows 7: <br><br> Files: <br> `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br> `%SystemDrive%:\Users\<USERNAME>\AppData\Local\Microsoft\Windows\UsrClass.dat` <br><br> Registry keys: <br> `NTUSER.DAT\Software\Microsoft\Windows\Shell\BagMRU` <br> `NTUSER.DAT\Software\Microsoft\Windows\Shell\Bags` <br> `UsrClass.dat\Local Settings\Software\Microsoft\Windows\Shell\BagMRU` <br> `UsrClass.dat\Local Settings\Software\Microsoft\Windows\Shell\Bags` |
| `Shimcache` | Programs execution. | File: `%SystemRoot%\System32\config\SYSTEM`  <br> Registry key: `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\AppCompatCache` |
| `SSHlogs` | Remote access / lateral movement | `%ProgramData%\ssh\logs` | `OpenSSH` for Windows logs in a text format. Not enabled by default (requires `SyslogFacility LOCAL0` / `LogLevel Debug3`) to be set in the server `sshd_config`. <br><br> Contains information about users successful and unsuccessful authentication attempts (with the associated IP source). |
| `System Resource Usage Monitor (SRUM)` <br><br> Introduced in Windows 8. | System usage including programs execution, network activity by process, etc. | `%SystemRoot%\System32\SRU\SRUDB.dat` |
| `Terminal Server Client\Servers` registry keys | IP address of the remote host(s) the user connected to (from the local system), stored as one key per remote host. <br><br> For each key: <br> - The `UsernameHint` value contains the eventual saved username for the connection. <br> - The last written timestamp may be an indicator of the first access to the remote host (but can also be updated for various other reasons). | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br> Registry key: `HKCU\SOFTWARE\Microsoft\Terminal Server Client\Servers\<IP>` |
| `TimeZoneInformation` Registry key | Time zone information. | File: `%SystemRoot%\System32\config\SYSTEM` <br> Registry key: `HKLM\System\ControlSet001\Control\TimeZoneInformation` |
| `TypedPaths` | Files and folders access. <br><br> Potential Programs execution. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat`  <br> Registry key:  `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths` |
| `TypedURLs` | Files and folders access. <br><br> Potential Programs execution. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat`  <br> Registry key:  `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\TypedURLs` |
| `UserAssist` | Programs execution. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat` <br> Registry key:  `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\<GUID>\Count` |
| `User Access Logging (UAL)` <br><br> Windows Server only, introduced in Windows Server 2012. | User access and DNS resolution. <br><br> Sessions opening on domain-joined computers in Domain Controllers UAL files. | Databases files (`.mdb`) in `%SystemRoot%\System32\Logfiles\SUM\` |
| `UsnJrnl` | Filesystem and limited filesystem history. | `\$Extend\$UsnJrnl` (`$Max` and `$J` data streams) |
| `Windows Background Activity Moderator (BAM)` <br><br> Introduced in Windows 10's Fall Creators update - version 1709. | Programs execution. | File: `%SystemRoot%\System32\config\SYSTEM` <br><br> Registry key: <br> `HKLM\SYSTEM\CurrentControlSet\Services\bam\UserSettings\<SID>\*` <br> After from Win10 1809: `HKLM\SYSTEM\CurrentControlSet\Services\bam\State\UserSettings\<SID>\*` |
| Windows Search | Files and folders access. | `%SystemDrive%:\ProgramData\Microsoft\Search\Data\Applications\Windows\Windows.edb` |
| `WordWheelQuery` | Files and folders access. <br><br> Potential Programs execution. | File: `%SystemDrive%:\Users\<USERNAME>\NTUSER.dat`  <br> Registry key:  `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\WordWheelQuery` |

--------------------------------------------------------------------------------

### References

https://blog.1234n6.com/2018/10/available-artifacts-evidence-of.html
